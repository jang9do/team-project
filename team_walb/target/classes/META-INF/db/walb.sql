-- 테이블 전체 삭제
DROP TABLE FUNDING;
DROP TABLE BUNAPPLY;
DROP TABLE BBOARD;
DROP TABLE HIT;
DROP TABLE AREPLY;
DROP TABLE ACTIRESULT;
DROP TABLE ACTIVITY;
DROP TABLE ABOARD;
DROP TABLE FBOARD;
DROP TABLE GBOARD;
DROP TABLE MESSAGE;
DROP TABLE SEARCH;
DROP TABLE PLACE;
DROP TABLE MEMBER;
DROP TABLE CIRCLE;
DROP TABLE MLEVEL;
DROP TABLE DEPT;

-- 부서
DROP SEQUENCE DEPT_SEQ;
CREATE SEQUENCE DEPT_SEQ;
CREATE TABLE DEPT(
    DEPTNO NUMBER(3) PRIMARY KEY,
    DNAME VARCHAR2(30) NOT NULL,
    DLOC VARCHAR2(100));

INSERT INTO DEPT VALUES(10, '총무부', '서초 WALB 2층');
INSERT INTO DEPT VALUES(20, '인사부', '서초 WALB 4층');
INSERT INTO DEPT VALUES(30, '재무부', '종로 WALB 1층');
INSERT INTO DEPT VALUES(40, '법무부', '용산 WALB 3층');
INSERT INTO DEPT VALUES(50, '영업부', '쌍문 WALB 5층');
    
-- 레벨
DROP SEQUENCE MLEVEL_SEQ;
CREATE SEQUENCE MLEVEL_SEQ;
CREATE TABLE MLEVEL(
    LNO NUMBER(1) PRIMARY KEY,
    LNAME VARCHAR2(30) NOT NULL);

INSERT INTO MLEVEL VALUES(1, 'ADMIN');
INSERT INTO MLEVEL VALUES(2, 'USER');
    
-- 동아리
DROP SEQUENCE CIRCLE_SEQ;
CREATE SEQUENCE CIRCLE_SEQ;
CREATE TABLE CIRCLE(
    CNUM NUMBER(3) PRIMARY KEY,
    CNAME VARCHAR2(100) NOT NULL,
    MID VARCHAR2(100) NOT NULL,
    CCONTENT VARCHAR2(1000),
    CTIME VARCHAR2(10),
    CHIT NUMBER(30),
    CPHOTO VARCHAR2(100));

-- 회원
DROP SEQUENCE MEMBER_SEQ;
CREATE SEQUENCE MEMBER_SEQ;
CREATE TABLE MEMBER(
    MID VARCHAR2(100) PRIMARY KEY,
    MPW VARCHAR2(100) NOT NULL,
    MNAME VARCHAR2(40) NOT NULL,
    MBIRTH DATE,
    MPHOTO VARCHAR2(200),
    LNO NUMBER(1),
    DEPTNO NUMBER(3),
    MJOIN DATE DEFAULT SYSDATE,
    MHIRE DATE,
    MOUT NUMBER(1) DEFAULT 0,
    MCIRCLE1 NUMBER(3),
    MCIRCLE2 NUMBER(3),
    MCIRCLE3 NUMBER(3),
    FOREIGN KEY(LNO) REFERENCES MLEVEL(LNO),
    FOREIGN KEY(DEPTNO) REFERENCES DEPT(DEPTNO),
    FOREIGN KEY(MCIRCLE1) REFERENCES CIRCLE(CNUM),
    FOREIGN KEY(MCIRCLE2) REFERENCES CIRCLE(CNUM),
    FOREIGN KEY(MCIRCLE3) REFERENCES CIRCLE(CNUM));

INSERT INTO MEMBER VALUES('master', '1111', '관리자', '1991-09-07', 'noImage.jpg', 1, 10, SYSDATE, '2010-03-01', 0, NULL, NULL, NULL);
INSERT INTO MEMBER VALUES('user', '1111', '회원1', '2001-01-01', 'noImage.jpg', 2, 30, SYSDATE, '2016-04-06', 0, NULL, NULL, NULL);
INSERT INTO MEMBER VALUES('user2', '1111', '회원1', '2001-01-01', 'noImage.jpg', 2, 30, SYSDATE, '2016-04-06', 0, NULL, NULL, NULL);

-- 제공장소
DROP SEQUENCE PLACE_SEQ;
CREATE SEQUENCE PLACE_SEQ;
CREATE TABLE PLACE(
    PNUM NUMBER(10) PRIMARY KEY,
    PNAME VARCHAR2(100) NOT NULL,
    PLOC VARCHAR2(200) NOT NULL,
    PPHOTO VARCHAR2(200));
    
INSERT INTO PLACE VALUES(PLACE_SEQ.NEXTVAL, '대강당', '서초 WALB 지하 1층', 'place1.jpg');

-- 검색어 순위
DROP SEQUENCE SEARCH_SEQ;
CREATE SEQUENCE SEARCH_SEQ;
CREATE TABLE SEARCH(
    SNUM NUMBER(30) PRIMARY KEY,
    SCON VARCHAR2(100) NOT NULL,
    SCOUNT NUMBER(30) DEFAULT 0);

-- 쪽지
DROP SEQUENCE MESSAGE_SEQ;
CREATE SEQUENCE MESSAGE_SEQ;
CREATE TABLE MESSAGE(
    MESNUM NUMBER(10) PRIMARY KEY,
    MESTO VARCHAR2(100),
    MESFROM VARCHAR2(100),
    MESTITLE VARCHAR2(100) NOT NULL,
    MESCONTENT VARCHAR2(1000) NOT NULL,
    MESDATE DATE,
    MESCHK NUMBER(1) DEFAULT 0,
    FOREIGN KEY(MESTO) REFERENCES MEMBER(MID),
    FOREIGN KEY(MESFROM) REFERENCES MEMBER(MID));
    
-- 공지 게시판
DROP SEQUENCE GBOARD_SEQ;
CREATE SEQUENCE GBOARD_SEQ;
CREATE TABLE GBOARD(
    GNUM NUMBER(10) PRIMARY KEY,
    MID VARCHAR2(100),
    GTITLE VARCHAR2(100) NOT NULL,
    GCONTENT CLOB NOT NULL,
    GIP VARCHAR2(100) NOT NULL,
    GDATE DATE DEFAULT SYSDATE,
    GFILE VARCHAR2(200),
    FOREIGN KEY(MID) REFERENCES MEMBER(MID));
    
-- 자유 게시판
DROP SEQUENCE FBOARD_SEQ;
CREATE SEQUENCE FBOARD_SEQ;
CREATE TABLE FBOARD(
    FNUM NUMBER(10) PRIMARY KEY,
    MID VARCHAR2(100),
    FTITLE VARCHAR2(100) NOT NULL,
    FCONTENT CLOB NOT NULL,
    FIP VARCHAR2(100) NOT NULL,
    FDATE DATE DEFAULT SYSDATE,
    FGROUP NUMBER(10) NOT NULL,
    FSTEP NUMBER(5),
    FINDENT NUMBER(5),
    CNUM NUMBER(3),
    FOREIGN KEY(MID) REFERENCES MEMBER(MID),
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM));
    
-- 후기 게시판
DROP SEQUENCE ABOARD_SEQ;
CREATE SEQUENCE ABOARD_SEQ;
CREATE TABLE ABOARD(
    ANUM NUMBER(10) PRIMARY KEY,
    CNUM NUMBER(3),
    ATITLE VARCHAR2(100) NOT NULL,
    ADATE DATE NOT NULL,
    BDATE DATE NOT NULL,
    ACONTENT CLOB NOT NULL,
    AIP VARCHAR2(100) NOT NULL,
    ASCORE NUMBER(2, 1) NULL,
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM));
    
-- 활동신청
DROP SEQUENCE ACTIVITY_SEQ;
CREATE SEQUENCE ACTIVITY_SEQ;
CREATE TABLE ACTIVITY(
    ACTINUM NUMBER(10) PRIMARY KEY,
    CNUM NUMBER(3),
    PNUM NUMBER(10),
    ACTITITLE VARCHAR2(100) NOT NULL,
    ACTIDATE DATE NOT NULL,
    ACTITIME NUMBER(1) NOT NULL,
    ACTICON CLOB NOT NULL,
    ACTICHK NUMBER(1),
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM));
    
-- 활동기록
DROP SEQUENCE ACTIRESULT_SEQ;
CREATE SEQUENCE ACTIRESULT_SEQ;
CREATE TABLE ACTIRESULT(
    ARNUM NUMBER(10) PRIMARY KEY,
    PNUM NUMBER(10),
    CNUM NUMBER(3),
    ARTITLE VARCHAR2(100) NOT NULL,
    ARDATE DATE NOT NULL,
    ARCON CLOB NOT NULL,
    ARRESULT NUMBER(1) DEFAULT 0,
    ANUM NUMBER(10),
    FOREIGN KEY(PNUM) REFERENCES PLACE(PNUM),
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM));
    
-- 후기평가리플
DROP SEQUENCE AREPLY_SEQ;
CREATE SEQUENCE AREPLY_SEQ;
CREATE TABLE AREPLY(
    RENUM NUMBER(30) PRIMARY KEY,
    MID VARCHAR2(100),
    ANUM NUMBER(10),
    RECONTENT VARCHAR2(1000) NOT NULL,
    REDATE DATE NOT NULL,
    RESCORE NUMBER(2, 1) DEFAULT 0,
    FOREIGN KEY(MID) REFERENCES MEMBER(MID),
    FOREIGN KEY(ANUM) REFERENCES ABOARD(ANUM));

-- 조회수 검색    
DROP SEQUENCE HIT_SEQ;
CREATE SEQUENCE HIT_SEQ;
CREATE TABLE HIT(
    HNUM NUMBER(30) PRIMARY KEY,
    CNUM NUMBER(3),
    MID VARCHAR2(100),
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM),
    FOREIGN KEY(MID) REFERENCES MEMBER(MID));

-- 번개게시판    
DROP SEQUENCE BBOARD_SEQ;
CREATE SEQUENCE BBOARD_SEQ;
CREATE TABLE BBOARD(
    BNUM NUMBER(10) PRIMARY KEY,
    CNUM NUMBER(3),
    BTITLE VARCHAR2(100) NOT NULL,
    BCONTENT CLOB NOT NULL,
    BSTART DATE DEFAULT SYSDATE,
    BEND DATE NOT NULL,
    BCOUNT NUMBER(3) DEFAULT 0,
    BPEOPLE NUMBER(3) NOT NULL,
    BACTI NUMBER(1) DEFAULT 0,
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM));
    
-- 번개 등록
DROP SEQUENCE BUNAPPLY_SEQ;
CREATE SEQUENCE BUNAPPLY_SEQ;
CREATE TABLE BUNAPPLY(
    BUNNUM NUMBER(30) PRIMARY KEY,
    BNUM NUMBER(10),
    MID VARCHAR2(100),
    FOREIGN KEY(BNUM) REFERENCES BBOARD(BNUM),
    FOREIGN KEY(MID) REFERENCES MEMBER(MID));
    
-- 펀딩 게시판
DROP SEQUENCE FUNDING_SEQ;
CREATE SEQUENCE FUNDING_SEQ;
CREATE TABLE FUNDING(
    FUNNUM NUMBER(10) PRIMARY KEY,
    FUNTITLE VARCHAR2(200) NOT NULL,
    CNUM NUMBER(3),
    FUNCON CLOB NOT NULL,
    FUNSTART DATE DEFAULT SYSDATE,
    FUNEND DATE NOT NULL,
    FUNIP VARCHAR2(200) NOT NULL,
    FUNGOLD NUMBER(10),
    FUNGOAL NUMBER(10),
    FOREIGN KEY(CNUM) REFERENCES CIRCLE(CNUM));
    
COMMIT;
